{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import { fetchedData } from './js/pixabay-api';\nimport { createGalleryMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\n\nconst form = document.querySelector('form');\nconst input = document.querySelector('input');\nconst loaderFirst = document.querySelector('.first');\nconst loaderSecond = document.querySelector('.second');\nconst gallery = document.querySelector('.gallery');\nconst loadButton = document.querySelector('.load-button');\n\nlet currentPage = 1;\nconst perPage = 15;\nlet searchedValue = '';\n\n\nconst onFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    searchedValue = input.value.trim();\n\n    currentPage = 1;\n\n    if (!searchedValue) {\n      iziToast.error({\n        message: 'Please enter a search query!',\n        position: 'topRight',\n      });\n      return;\n    }\n\n    loaderFirst.classList.remove('is-hidden');\n\n    const response = await fetchedData(searchedValue, currentPage);\n\n    gallery.innerHTML = '';\n\n    if (response.data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n\n      form.reset();\n      return;\n    }\n\n    const galleryMarkup = response.data.hits.map(createGalleryMarkup).join('');\n    gallery.innerHTML = galleryMarkup;\n\n    if (response.data.hits.length < perPage) {\n      loadButton.classList.add('is-hidden');\n      iziToast.error({\n        message:\n          'We are sorry, but you have reached the end of search results!',\n        position: 'center',\n      });\n    } else {\n      loadButton.classList.remove('is-hidden');\n    }\n\n    galleryLibrary.refresh();\n  } catch (err) {\n    iziToast.error({\n      message: `${err}`,\n      position: 'center',\n    });\n  } finally {\n    loaderFirst.classList.add('is-hidden');\n    form.reset();\n  }\n};\n\nconst onLoadButtonClick = async event => {\n  try {\n    event.preventDefault();\n\n    currentPage++;\n    loaderSecond.classList.remove('is-hidden');\n\n    const response = await fetchedData(searchedValue, currentPage);\n\n    const galleryMarkup = response.data.hits.map(createGalleryMarkup).join('');\n    gallery.insertAdjacentHTML('beforeend', galleryMarkup);\n\n    let elem = document.querySelector('.gallery-item');\n    let rect = elem.getBoundingClientRect();\n    window.scrollBy({\n      top: 2 * rect.height,\n      behavior: 'smooth',\n    });\n\n    galleryLibrary.refresh();\n\n    const totalResults = response.data.total;\n    const totalPages = Math.ceil(totalResults / perPage);\n\n    if (currentPage >= totalPages || response.data.hits.length < perPage) {\n      loadButton.classList.add('is-hidden');\n      return iziToast.error({\n        message:\n          'We are sorry, but you have reached the end of search results!',\n        position: 'center',\n      });\n    }\n  } catch (err) {\n    iziToast.error({\n      message: `${err}`,\n      position: 'center',\n    });\n  } finally {\n    loaderSecond.classList.add('is-hidden');\n  }\n};\n\nlet galleryLibrary = new SimpleLightbox('.gallery li a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n  captionsPosition: 'bottom',\n});\n\nform.addEventListener('submit', onFormSubmit);\nloadButton.addEventListener('click', onLoadButtonClick);"],"names":["form","input","loaderFirst","loaderSecond","gallery","loadButton","currentPage","perPage","searchedValue","onFormSubmit","event","iziToast","response","fetchedData","galleryMarkup","createGalleryMarkup","galleryLibrary","err","onLoadButtonClick","rect","totalResults","totalPages","SimpleLightbox"],"mappings":"wHAKA,MAAMA,EAAO,SAAS,cAAc,MAAM,EACpCC,EAAQ,SAAS,cAAc,OAAO,EACtCC,EAAc,SAAS,cAAc,QAAQ,EAC7CC,EAAe,SAAS,cAAc,SAAS,EAC/CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAa,SAAS,cAAc,cAAc,EAExD,IAAIC,EAAc,EAClB,MAAMC,EAAU,GAChB,IAAIC,EAAgB,GAGpB,MAAMC,EAAe,MAAMC,GAAS,CAClC,GAAI,CAOF,GANAA,EAAM,eAAc,EAEpBF,EAAgBP,EAAM,MAAM,OAE5BK,EAAc,EAEV,CAACE,EAAe,CAClBG,EAAS,MAAM,CACb,QAAS,+BACT,SAAU,UAClB,CAAO,EACD,MACD,CAEDT,EAAY,UAAU,OAAO,WAAW,EAExC,MAAMU,EAAW,MAAMC,EAAYL,EAAeF,CAAW,EAI7D,GAFAF,EAAQ,UAAY,GAEhBQ,EAAS,KAAK,KAAK,SAAW,EAAG,CACnCD,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UAClB,CAAO,EAEDX,EAAK,MAAK,EACV,MACD,CAED,MAAMc,EAAgBF,EAAS,KAAK,KAAK,IAAIG,CAAmB,EAAE,KAAK,EAAE,EACzEX,EAAQ,UAAYU,EAEhBF,EAAS,KAAK,KAAK,OAASL,GAC9BF,EAAW,UAAU,IAAI,WAAW,EACpCM,EAAS,MAAM,CACb,QACE,gEACF,SAAU,QAClB,CAAO,GAEDN,EAAW,UAAU,OAAO,WAAW,EAGzCW,EAAe,QAAO,CACvB,OAAQC,EAAK,CACZN,EAAS,MAAM,CACb,QAAS,GAAGM,CAAG,GACf,SAAU,QAChB,CAAK,CACL,QAAY,CACRf,EAAY,UAAU,IAAI,WAAW,EACrCF,EAAK,MAAK,CACX,CACH,EAEMkB,EAAoB,MAAMR,GAAS,CACvC,GAAI,CACFA,EAAM,eAAc,EAEpBJ,IACAH,EAAa,UAAU,OAAO,WAAW,EAEzC,MAAMS,EAAW,MAAMC,EAAYL,EAAeF,CAAW,EAEvDQ,EAAgBF,EAAS,KAAK,KAAK,IAAIG,CAAmB,EAAE,KAAK,EAAE,EACzEX,EAAQ,mBAAmB,YAAaU,CAAa,EAGrD,IAAIK,EADO,SAAS,cAAc,eAAe,EACjC,wBAChB,OAAO,SAAS,CACd,IAAK,EAAIA,EAAK,OACd,SAAU,QAChB,CAAK,EAEDH,EAAe,QAAO,EAEtB,MAAMI,EAAeR,EAAS,KAAK,MAC7BS,EAAa,KAAK,KAAKD,EAAeb,CAAO,EAEnD,GAAID,GAAee,GAAcT,EAAS,KAAK,KAAK,OAASL,EAC3D,OAAAF,EAAW,UAAU,IAAI,WAAW,EAC7BM,EAAS,MAAM,CACpB,QACE,gEACF,SAAU,QAClB,CAAO,CAEJ,OAAQM,EAAK,CACZN,EAAS,MAAM,CACb,QAAS,GAAGM,CAAG,GACf,SAAU,QAChB,CAAK,CACL,QAAY,CACRd,EAAa,UAAU,IAAI,WAAW,CACvC,CACH,EAEA,IAAIa,EAAiB,IAAIM,EAAe,gBAAiB,CACvD,SAAU,GACV,aAAc,MACd,aAAc,IACd,eAAgB,GAChB,iBAAkB,QACpB,CAAC,EAEDtB,EAAK,iBAAiB,SAAUS,CAAY,EAC5CJ,EAAW,iBAAiB,QAASa,CAAiB"}